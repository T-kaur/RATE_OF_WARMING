clear all
clc


global e m a h K ropt Tr Sr Am eps del
 

format long
alpha2=0.06;
ts=0:0.01:20000; %%time span
 
eps=0.001;del=0.1;
Tr=290.15;
e=5.99189*10^(-4);
a=217.59894;h=0.004;m=0.12;K=9;Sr=6;ropt=78.8399;Am=10000;

rst=m/(a*(e-m*h));%Rstar
v1=(ropt*exp(-(290-Tr).^2/(2*Sr*Sr)));
ini=[rst  (v1./(a)).*(1-rst/K).*(1+a*h*rst) 290];


%% T<T_opt
alpha1=-0.06;

f=@(t,z)[(1/(del*eps))*(ropt*exp(-(z(3)-Tr)^2/(2*Sr*Sr))*z(1)*(1-(z(1)/K))-((a*z(1)*z(2))/(1+a*h*z(1))));(1/del)*((e*a*z(1)*z(2))/(1+a*h*z(1))- (m*z(2)));alpha1];

[ts,zz]=ode23s(f,ts,ini); %% ode solver
pp=find(zz(:,3)<273);
ind=min(pp);

subplot(2,2,1)
plot(zz(1:2500:ind,3),zz(1:2500:ind,1))
hold on;

subplot(2,2,3)
plot(zz(1:2500:ind,3),zz(1:2500:ind,2))
hold on;


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% T>T_opt


f=@(t,z)[(1/(del*eps))*(ropt*exp(-(z(3)-Tr)^2/(2*Sr*Sr))*z(1)*(1-(z(1)/K))-((a*z(1)*z(2))/(1+a*h*z(1))));(1/del)*((e*a*z(1)*z(2))/(1+a*h*z(1))- (m*z(2)));alpha2];

 
[ts,zz]=ode23s(f,ts,ini); %% ode solver
pp=find(zz(:,3)>313);
ind=min(pp);

subplot(2,2,2)
plot(zz(1:2500:ind,3),zz(1:2500:ind,1))
hold on;

subplot(2,2,4)
plot(zz(1:2500:ind,3),zz(1:2500:ind,2))
hold on;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

